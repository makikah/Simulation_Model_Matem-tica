---
title: "Prova HO-012"
author: "Economia Matem√°tia e Simula√ß√£o"
date: "Junho de 2019"
header-includes:
- \usepackage{setspace}
- \usepackage{float}
- \usepackage{color}
- \usepackage{hyperref}
- \floatplacement{table}{H}
includes:
  in_header: preamble-latex.tex
output:
  pdf_document:
    toc: no
  word_document:
    toc: yes
  html_document:
    highlight: tango
    theme: cerulean
    toc: yes
---

# Quest„o 1: Modelo de Hicks

A seÁ„o 6.3 do livro texto (Gandolfo, 2010) descreve a forma mais simples do modelo de Hicks. As equaÁıes b·sicas que definem o modelo, a partir da extens„oo do modelo de interaÁ„o do multiplicador-acelerador de Samuelson s„o

\[  Y_t = C_t +I_t \]
\[  C_t = bY_{t-1} \]
\[  I_t = I^{'}_t+I^{''}_{t} \]
\[  I^{'}_t = k(Y_{t-1} - Y_{t-2}) \]
\[  I^{''}_t = A_0(1+g)^t \]

onde

* $Y_t$ È a renda total;
* $C_t$ È o consumo das famÌlias;
* $I_t$ È o investimento total;
* $I^{'}_t$ È o investimento induzido;
* $I^{''}_t$ È o investimento autÙnomo 

Note-se que as principais modificaÁıes que o modelo incorpora se comparado ao modelo de Samuelson s„o: a) o investimento autÙnomo que cresce a uma taxa $g$ exÛgena e constante no tempo; b) a dependÍncia do investimento agregado sobre renda total e c) o investimento induzido como funÁ„o da variaÁ„o da renda total em $t-1$ e em $t-2$. 

Especificando os valores dos par‚metros que sejam necess·rios

a) Em funÁ„o dos par‚metros do modelo e o discriminante do polinÙmio caracterÌstico resultante, especifique as condiÁıes de estabilidade e an·lise a factibilidade de cada cen·rio possÌvel;

Se as raÌzes do polinÙmio caracterÌstico s„o reais, i.e., quando o discriminante È igual ou maior que zero, as condiÁıes de estabilidade s„o dadas por:
$$1 + a_1 + a_0 > 0$$
$$1 - a_1 + a_0 > 0$$
$$1 - a_0 > 0$$
No entanto, se as raÌzes s„o imagin·rias, i.e., quando o discriminante È menor que zero, tem-se:

$$R=\sqrt a_0 < 1$$
Inicialmente, resolvendo todas as equaÁıes para $Y$, pode-se resumir o modelo em uma ˙nica equaÁ„o:
$$Y_t - bY_{t-1} - kY_{t-1} + kY_{t-2} - A_0(1+g)^t = 0$$
$$kY_{t-2} - (b+k)Y_{t-1} + Y_t = A_0(1+g)^t$$
Adiantando os Ìndices por dois perÌodos:
$$Y_{t+2} - (b+k)Y_{t+1} + kY_t = A_0(1+g)^{t+2}$$

De modo que $a_2 = 1$, $a_1 = -(b + k)$ e $a_0 = k$.

Os par‚metros do modelo s„o especificados como:
```{r}
b = 0.9 # propens„o a consumir
k = 0.4 # coeficiente de aceleraÁ„o
a0 = k
a1 = -(b + k)
a2 = 1
A0 = 1
g = 0.02
```

O discriminante ($\Delta$) pode ent„o ser calculado como:

$$\Delta = a_1^2 - 4a_2a_0*$$

```{r}
delta = a1^2 - 4*a2*a0
delta
```
Uma vez que o valor È maior que zero, tem-se, como soluÁ„o, raÌzes reais distintas no polinÙmio caracterÌstico. Neste caso, as condiÁıes de estabilidade aplicadas referem-se ao caso de raÌzes reais. Isto È:

```{r}
1 + a1 + a0 > 0
1 - a1 + a0 > 0
1 - a0 > 0
```
Dado que as trÍs condiÁıes s„o verdadeiras, o sistema È est·vel para os valores dos par‚metros considerados. De fato, pode-se verificar isso a partir das raÌzes do sistema:

```{r}
coefs = c(a0, a1, a2)
roots = polyroot(coefs)
roots
```
Isto È, ambas tem valor inferior a 1; sendo que mesmo a raiz dominante tem valor menor que 1 (= 0,8).


b) Implemente o modelo no R e apresente as trajetÛrias temporais da renda, investimento e consumo das famÌlias para um caso est·vel e um caso inst·vel, comparando ambos os cen·rios;

Utilizam-se os pacotes:

```{r}
library(ggplot2)
library(tidyr)
```

Caso est·vel:

```{r}

b = 0.9 # propens„o a consumir
k = 0.4 # coeficiente de aceleraÁ„o
a0 = k
a1 = -(b + k)
a2 = 1
A0 = 10
g = 0.02

delta = a1^2 - 4*a2*a0
delta

coefs = c(a0, a1, a2)
roots = polyroot(coefs)
roots
````

```{r}
tmax = 100
Y = rep(0,tmax)
C = rep(0,tmax)
I1 = rep(0,tmax)
I2 = rep(0,tmax)
I = rep(0,tmax)

Y[1] = 50  #valor inicial da renda nacional
Y[2] = 60  #valor inicial da renda nacional


for (t in 3:tmax) {
  Y[t] = C[t] + I[t]
  C[t] = b*Y[t-1]
  I1[t] = k*(Y[t-1] - Y[t-2])
  I2[t] = A0*(1+g)^t
  I[t] = I1[t] + I2[t]
}

t = seq(1, tmax, 1)

series = data.frame(t, Y, C, I1, I2, I)
series

series_tidy <- gather( series, -t, key = "serie", value = "valor" )
names(series_tidy)

ggplot(series_tidy, aes(x=t, y = valor, group=serie, color = serie) ) +
geom_line(size=1) +
theme_light()
```

Caso inst·vel

```{r}
b = 1.8 # propens„o a consumir
k = 0.3 # coeficiente de aceleraÁ„o
a0 = k
a1 = -(b + k)
a2 = 1
A0 = 10
g = 0.02

delta = a1^2 - 4*a2*a0
delta

coefs = c(a0, a1, a2)
roots = polyroot(coefs)
roots
```

```{r}
tmax = 100
Y = rep(0,tmax)
C = rep(0,tmax)
I1 = rep(0,tmax)
I2 = rep(0,tmax)
I = rep(0,tmax)

Y[1] = 50  #valor inicial da renda nacional
Y[2] = 60  #valor inicial da renda nacional


for (t in 3:tmax) {
  Y[t] = C[t] + I[t]
  C[t] = b*Y[t-1]
  I1[t] = k*(Y[t-1] - Y[t-2])
  I2[t] = A0*(1+g)^t
  I[t] = I1[t] + I2[t]
}

t = seq(1, tmax, 1)

series = data.frame(t, Y, C, I1, I2, I)
series

series_tidy <- gather( series, -t, key = "serie", value = "valor" )
names(series_tidy)

ggplot(series_tidy, aes(x=t, y = valor, group=serie, color = serie) ) +
geom_line(size=1) +
theme_light()
```

c) Determine a forma explÌcita da trajetÛria temporal para $Y_t$ para um conjunto de par‚metros tal que a economia apresente ciclos amortecidos. Utilize o R para realizar os c·lculos e apresente a sequÍncia de comandos utilizada;

Neste caso, para que tal resultado ocorra (raÌzes complexas conjugadas est·veis) È necess·rio que o discriminante seja menor que um e que o mÛdulo $R=\sqrt a_0 <1$.

```{r}
b = 0.9 # propens„o a consumir
k = 0.7 # coeficiente de aceleraÁ„o
a0 = k
a1 = -(b + k)
a2 = 1
A0 = 10
g = 0.02

delta = a1^2 - 4*a2*a0
delta

coefs = c(a0, a1, a2)
roots = polyroot(coefs)
roots
R = Mod(roots[1])
R
```
Nota-se que o discriminante È menor que zero e o mÛdulo de R È menor que 1. Assim, tem-se um sistema com ciclos e convergente (ciclos amortecidos). 
OBS: REVER ESTE QUESITO DEPOIS. PARECE-ME INCOMPLETA.

d) Considere a abertura da economia hipotÈtica do modelo, tal que as importaÁıes $M_t$ dependem da renda do perÌodo anterior ($M_t = mY_{t-1};~0<m<1$). As exportaÁıes, determinadas pela demanda externa sofrem variaÁıes a uma taxa $g_x$ tal que
    \[ X_t  = X_0(1+g_x)^t \]

Por simulaÁ„o, analise o balanÁo de pagamentos ($X_t,~M_t$) no longo prazo. Discuta sobre a condiÁ„o de estabilidade. Ela foi alterada?;

Com a introduÁ„o do setor externo, o modelo deve ser escrito como:

$$Y_t = C_t + I_t + X_t - M_t$$
Introduzindo as novas especificaÁıes e resolvendo o conjunto de equaÁıes para $Y$, vem

$$Y_t - (b+k)Y_{t-1} + kY_{t-2} + mY_{t-1} = A_0(1+g)^t + X_0(1+g_x)^t$$
Adiantando, mais uma vez, dois perÌodos, chega-se a
$$Y_{t+2} - (b+k)Y_{t+1} + kY_t + mY_{t+1} = A_0(1+g)^{t+2} + X_0(1+g_x)^{t+2}$$
$$Y_{t+2} - (b+k-m)Y_{t+1} + kY_t = A_0(1+g)^{t+2} + X_0(1+g_x)^{t+2}$$

```{r}
b = 0.9 # propens„o a consumir
k = 0.4 # coeficiente de aceleraÁ„o
m = 0.2 # propens„o a importar
A0 = 10
g = 0.02
X0 = 10
gx = 0.01
a0 = k
a1 = -(b + k - m)
a2 = 1

delta = a1^2 - 4*a2*a0
delta

coefs = c(a0, a1, a2)
roots = polyroot(coefs)
roots
R = Mod(roots[1])
R
```
A inclus„o do setor externo n„o torna o sistema inst·vel. No entanto, o sistema passa agora apresentar ciclos amortecidos.

```{r}
tmax = 100

Y = rep(0,tmax)
C = rep(0,tmax)
I1 = rep(0,tmax)
I2 = rep(0,tmax)
I = rep(0,tmax)
X = rep(0,tmax)
M = rep(0,tmax)
BP = rep(0, tmax)

Y[1] = 50
Y[2] = 60

for (t in 3:tmax) {
  Y[t] = C[t] + I[t] + X[t] - M[t]
  C[t] = b*Y[t-1]
  I1[t] = k*(Y[t-1] - Y[t-2])
  I2[t] = A0*(1+g)^t
  I[t] = I1[t] + I2[2]
  BP[t] = X0*(1+gx)^t - m*Y[t-1]  #din‚mica do balanÁo de pagamentos ao longo do tempo
}

t = seq(1, tmax, 1)

series = data.frame(t, Y, C, I1, I2, BP)
series

series_tidy <- gather( series, -t, key = "serie", value = "valor" )
names(series_tidy)

ggplot(series_tidy, aes(x=t, y = valor, group=serie, color = serie) ) +
geom_line(size=1) +
theme_light()
```


e) Se, considerando o caso anterior alteramos o modelo tal que $M_t = m_1C_t + m_2I_t$, $0<m_1<1;~0<m_2<1$ e $X_t = X_0(1+g_x)^t$. Analise as condi√ß√µes de estabilidade. H· diferenÁa? Auxilie-se com a simulaÁ„o do modelo.

```{r}
b = 0.7 # propens„o a consumir
k = 0.2 # coeficiente de aceleraÁ„o
A0 = 1
g = 0.02
X0 = 5
gx = 0.02
m1 = 0.3
m2 = 0.4
a0 = 0.2
a1 = - b - k
a2 = 1

tmax = 100

Y = rep(0,tmax)
C = rep(0,tmax)
I1 = rep(0,tmax)
I2 = rep(0,tmax)
I = rep(0,tmax)
X = rep(0,tmax)
M = rep(0,tmax)

C[t] = b*Y[t-1]
I1[t] = k*(Y[t-1] - Y[t-2])
I2[t] = A0*(1+g)^t
I[t] = I1[t] + I2[t]
X[t] = X0*(1+gx)^t
M[t] = m1*C[t] + m2*I[t]
Y[t] = C[t] + I[t] + X[t] - M[t]

Y[1] = 3
Y[2] = 4

for (t in 3:tmax) {
  C[t] = b*Y[t-1]
  I1[t] = k*(Y[t-1] - Y[t-2])
  I2[t] = A0*(1+g)^t
  I[t] = I1[t] + I2[t]
  X[t] = X0*(1+gx)^t
  M[t] = m1*C[t] + m2*I[t]
  Y[t] = C[t] + I[t] + X[t] - M[t]
}

t = seq(1, tmax, 1)

series = data.frame(t, Y, C, I1, I2, X, M)
series

series_tidy <- gather( series, -t, key = "serie", value = "valor" )
names(series_tidy)

ggplot(series_tidy, aes(x=t, y = valor, group=serie, color = serie) ) +
geom_line(size=1) +
theme_light()
```


# Quest„o 2: O modelo de ciclo econÙmico de Kalecki

Simule o modelo de ciclo econÙmico de Kalecki, considerando um modelo linear de coeficientes constantes de ordem 2. Analise as condi√ß√µes de estabilidade. Para se auxiliar, veja o texto de Possas e Baltar (1983) dispon√≠vel em <http://bibliotecadigital.fgv.br/ojs/index.php/bre/article/view/3154/2050>. 

que resume bem aquilo que √© necess√°rio para realizar a simula√ß√£o. 

A vers√£o mais simples √© suficiente (se√ß√£o 2.1 desse artigo. A interpreta√ß√£o est√° na se√ß√£o 2.2). Por√©m, sinta-se √† vontade caso j√° tenha come√ßado a simula√ß√£o de uma das outras vers√µes.

a) Elabore a descriÁ„o do modelo e a representaÁ„o formal do mesmo (as equaÁıes);



b) Determine as condi√ß√µes de estabilidade do modelo em fun√ß√£o dos par√¢metros;

O modelo com ciclo para ser est·vel requer que $R=\sqrt a_0=\sqrt {m+n}<1$.


c) Simule um caso est√°vel e um caso inst√°vel.

Caso est·vel
```{r}

m = 0.6
n = 0.1
a2 = 1
a1 = -(m + 1)
a0 = m + n
discriminante = a0^2 + 4*a1*a2
discriminante
B = 5
U = 1
lambda = 0.6

tmax = 50

P = rep(0, tmax)
C = rep(0, tmax)
I = rep(0, tmax)
A = rep(0, tmax)
K = rep(0, tmax)

C[t] = B + lambda*P[t]
I[t] = m*(B + A[t]) - n*K[t]
P[t] = C[t] + A[t]


K[1] = 10
K[2] = 15

for (t in 3:tmax) {
  C[t] = B + lambda*P[t]
  I[t] = m*(B + A[t]) - n*K[t]
  P[t] = C[t] + A[t]
}

t = seq(1, tmax, 1)

series = data.frame(t, K, P, C, I, A)
series

series_tidy <- gather( series, -t, key = "serie", value = "valor" )
names(series_tidy)

ggplot(series_tidy, aes(x=t, y = valor, group=serie, color = serie) ) +
geom_line(size=1) +
theme_light()

```


\vspace{0.50cm}

**Prazo de entrega**: at√© segunda feira por√©m este prazo √© negoci√°vel sob demanda. O importante √© realizar os exerc√≠cios. 
